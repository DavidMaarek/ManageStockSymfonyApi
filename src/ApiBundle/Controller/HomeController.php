<?phpnamespace ApiBundle\Controller;use Symfony\Component\HttpFoundation\Request;use FOS\RestBundle\Controller\Annotations as Rest;use Symfony\Component\HttpKernel\Exception\NotFoundHttpException;class HomeController extends MainController{    /**     * @param Request $request     * @return mixed     * @Rest\View(serializerGroups={"home"})     * @Rest\Get("/home")     */    public function getHomeAction(Request $request)    {        $stocksId = $this->giveMeUserStocks($request);        $userId = $this->giveMeUserId($request);        if (empty($stocksId)) {            throw new NotFoundHttpException('Vous n\'avez aucun stock');        }        $em = $this->getDoctrine()->getManager();        $stocks = $em->getRepository('ApiBundle:Stock')->findById($stocksId);        foreach ($stocks as $stock) {            foreach ($stock->getStockAccesses() as $stockAccess) {                if($userId !== $stockAccess->getUser()->getId()) {                    $stock->removeStockAccess($stockAccess);                }            }        }        return $stocks;    }    /**     * @param Request $request     * @return mixed     * @Rest\View(serializerGroups={"segments"})     * @Rest\Get("/segments")     */    public function getSegmentsAction(Request $request)    {        $stocksId = $this->giveMeUserStocks($request);        if (empty($stocksId)) {            throw new NotFoundHttpException('Vous n\'avez aucun stock');        }        $em = $this->getDoctrine()->getManager();        $stocks = $em->getRepository('ApiBundle:Stock')->findById($stocksId);        return $stocks;    }}